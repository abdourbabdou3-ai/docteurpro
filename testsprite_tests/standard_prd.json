{
  "meta": {
    "project": "دكتور - منصة حجز المواعيد الطبية",
    "date": "2026-02-21",
    "prepared_by": "Generated by TestSprite"
  },
  "product_overview": "دكتور is an Arabic RTL SaaS platform to connect patients and doctors in Algeria, allowing patients to search doctors and book appointments while doctors manage appointments and profiles through a dashboard. The platform includes an admin panel for approval and subscription management.",
  "core_goals": [
    "Allow patients to browse and search doctors by specialty and city without registering",
    "Enable quick appointment booking using patient name and phone",
    "Provide authenticated doctors with a dashboard to manage appointments, patient records, and profile",
    "Provide admin controls for approving doctors, managing subscription plans, and viewing platform statistics",
    "Support Arabic RTL interface and keep authentication and API interactions secure",
    "Handle service reliability concerns and clearly surface DB/API errors (known P1001 Supabase connection issue)"
  ],
  "features": [
    {
      "name": "Doctor Search and Listing",
      "description": "Patients can search and filter doctors by specialty and city, view doctor cards with ratings and pricing, and open doctor profiles.",
      "user_flows": [
        "Navigate to /doctors -> Enter specialty or city in search bars -> Click search button -> View doctor cards with ratings and prices -> Click a doctor card -> Navigate to /doctors/[id]",
        "Navigate to / -> Enter specialty or city in search bars on home -> Click search button -> View doctor cards with ratings and prices",
        "Navigate to /doctors -> Enter specialty or city in search bars -> Click search button -> See 'No results found' message when no matches",
        "Navigate to /doctors -> Enter specialty or city in search bars -> Click search button -> Receive 500 error message due to database connection"
      ]
    },
    {
      "name": "Appointment Booking",
      "description": "Patients (without creating an account) can select a doctor, pick an available date and time, enter basic patient info, and confirm a booking.",
      "user_flows": [
        "Navigate to /doctors/[id] -> Select a date and time slot -> Fill patient information (name) -> Fill patient information (phone) -> Confirm booking -> See booking confirmation message",
        "Navigate to /doctors/[id] -> Select a date and time slot -> Fill patient information (name) -> Leave phone field empty -> Confirm booking -> See validation error indicating phone is required",
        "Navigate to /doctors/[id] -> Select a date and time slot -> Fill patient information (name, phone) -> Confirm booking -> Receive 500 error due to database connection when saving appointment"
      ]
    },
    {
      "name": "Doctor Authentication (Login & Register)",
      "description": "Doctors can register for an account and log in to access their dashboard and management features.",
      "user_flows": [
        "Navigate to /login -> Fill email field -> Fill password field -> Click Login button -> Redirect to /dashboard -> See doctor dashboard",
        "Navigate to /login -> Fill email field -> Fill incorrect password -> Click Login button -> See invalid credentials error message",
        "Navigate to /register -> Fill registration form fields -> Submit registration -> See registration success or 'awaiting admin approval' message",
        "Navigate to /register -> Submit incomplete registration form -> See validation errors for required fields"
      ]
    },
    {
      "name": "Doctor Dashboard",
      "description": "Authenticated doctors view appointment statistics, manage upcoming appointments (confirm/cancel/complete), update profile and working hours, and access patient records.",
      "user_flows": [
        "Navigate to /dashboard -> Authenticate if prompted -> See appointment statistics loaded from /api/dashboard/stats -> Click an upcoming appointment card -> Choose to confirm appointment -> See appointment status updated",
        "Navigate to /dashboard -> Authenticate if prompted -> See appointment statistics loaded from /api/dashboard/stats -> Click an upcoming appointment card -> Choose to cancel appointment -> See appointment status updated",
        "Navigate to /dashboard -> Not signed in -> Be redirected to /login",
        "Navigate to /dashboard -> Authenticate -> Attempt to load statistics -> Receive 500 error due to database connection when fetching /api/dashboard/stats"
      ]
    },
    {
      "name": "Admin Panel",
      "description": "Platform administrators review and approve doctor registrations, manage subscription packages, approve subscription requests, and view platform statistics.",
      "user_flows": [
        "Navigate to /admin -> Authenticate as admin -> View list of doctor applications -> Click Approve on a doctor application -> See application status updated to approved",
        "Navigate to /admin -> Authenticate as admin -> View subscription package list -> Update subscription package details -> See package update confirmation",
        "Navigate to /admin -> Authenticate as non-admin -> Attempt to access admin pages -> See insufficient permissions / 403 message",
        "Navigate to /admin -> Authenticate as admin -> Load applications list -> Receive 500 error due to database connection when fetching data"
      ]
    }
  ],
  "code_summary": {
    "version": "2",
    "type": "frontend",
    "tech_stack": [
      "TypeScript",
      "Next.js 14",
      "React 18",
      "Prisma",
      "NextAuth.js",
      "Vanilla CSS"
    ],
    "routes": [
      {
        "path": "/",
        "file": "src/app/page.tsx",
        "auth_required": false,
        "description": "Home page with doctor search and hero section"
      },
      {
        "path": "/doctors",
        "file": "src/app/doctors/page.tsx",
        "auth_required": false,
        "description": "List of all doctors with filters"
      },
      {
        "path": "/about",
        "file": "src/app/about/page.tsx",
        "auth_required": false,
        "description": "About the platform page"
      },
      {
        "path": "/contact",
        "file": "src/app/contact/page.tsx",
        "auth_required": false,
        "description": "Contact form page"
      },
      {
        "path": "/login",
        "file": "src/app/login/page.tsx",
        "auth_required": false,
        "description": "User login page"
      },
      {
        "path": "/register",
        "file": "src/app/register/page.tsx",
        "auth_required": false,
        "description": "Doctor registration page"
      },
      {
        "path": "/dashboard",
        "file": "src/app/dashboard/page.tsx",
        "auth_required": true,
        "description": "Doctor dashboard for managing appointments"
      },
      {
        "path": "/admin",
        "file": "src/app/admin/page.tsx",
        "auth_required": true,
        "description": "Admin panel for platform management"
      }
    ],
    "features": [
      {
        "name": "Doctor Search and Listing",
        "description": "Users can search for doctors by specialty and city",
        "files": [
          "src/app/page.tsx",
          "src/app/doctors/page.tsx",
          "src/app/api/doctors/route.ts"
        ],
        "entry_route": "/doctors",
        "user_interactions": [
          "Enter specialty or city in search bars",
          "Click search button",
          "View doctor cards with ratings and prices"
        ],
        "api_calls": [
          {
            "method": "GET",
            "endpoint": "/api/doctors"
          }
        ],
        "auth_required": false
      },
      {
        "name": "Appointment Booking",
        "description": "Patients can book appointments with doctors",
        "files": [
          "src/app/doctors/[id]/page.tsx",
          "src/app/api/appointments/route.ts"
        ],
        "entry_route": "/doctors/[id]",
        "user_interactions": [
          "Select a date and time slot",
          "Fill patient information (name, phone)",
          "Confirm booking"
        ],
        "api_calls": [
          {
            "method": "POST",
            "endpoint": "/api/appointments"
          }
        ],
        "auth_required": false
      },
      {
        "name": "Doctor Authentication",
        "description": "Doctors can login and register",
        "files": [
          "src/app/login/page.tsx",
          "src/app/register/page.tsx",
          "src/app/api/auth/[...nextauth]/route.ts"
        ],
        "entry_route": "/login",
        "user_interactions": [
          "Fill login/register forms",
          "Submit credentials"
        ],
        "api_calls": [
          {
            "method": "POST",
            "endpoint": "/api/auth/callback/credentials"
          }
        ],
        "auth_required": false
      },
      {
        "name": "Doctor Dashboard",
        "description": "Doctors manage their appointments and profile",
        "files": [
          "src/app/dashboard/page.tsx",
          "src/app/api/dashboard/stats/route.ts"
        ],
        "entry_route": "/dashboard",
        "user_interactions": [
          "View appointment statistics",
          "Manage upcoming appointments",
          "Update profile settings"
        ],
        "api_calls": [
          {
            "method": "GET",
            "endpoint": "/api/dashboard/stats"
          }
        ],
        "auth_required": true
      }
    ],
    "known_limitations": [
      {
        "issue": "Database connection to Supabase is currently unstable (P1001)",
        "location": "src/lib/prisma.ts",
        "impact": "API routes fetching data from DB will return 500 errors until fixed or migrated"
      }
    ]
  }
}
